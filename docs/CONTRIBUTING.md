# 開発ルール

## ブランチ命名規則

### 基本形式

```
{タイプ}/{番号}-{簡潔な説明}
```

### 例

```
feature/123-チャット機能追加
fix/456-ログインリダイレクト修正
hotfix/789-セキュリティ緊急パッチ
refactor/101-認証処理リファクタリング
```

### タイプ一覧

- `feature/` - 新機能追加
- `fix/` - バグ修正
- `hotfix/` - 緊急修正（本番環境の重大な問題）
- `refactor/` - リファクタリング
- `docs/` - ドキュメント更新
- `chore/` - その他の作業

## コミットメッセージ

### 基本形式

```
{タイプ}({スコープ}): {変更内容の簡潔な説明}

{詳細説明（必要に応じて）}
```

### 例

```
feat(frontend): メッセージ暗号化機能を追加

- エンドツーエンド暗号化を実装
- 暗号化キーの管理機能を追加
- セキュリティテストを追加

fix(backend-go): ログイン後のリダイレクト問題を修正

- 認証成功後の遷移先を正しく設定
- セッション管理の改善

docs: セットアップ手順を更新

- 新しい依存関係の追加手順を記載
- 環境変数の設定例を追加

refactor(frontend): 認証処理をリファクタリング

- 認証フックの共通化
- エラーハンドリングの改善
- コードの可読性向上

chore(backend-python): 依存関係を更新

- FastAPIをv0.104.0に更新
- セキュリティパッチを適用
```

### タイプ一覧

- `feat:` - 新機能追加
- `fix:` - バグ修正
- `docs:` - ドキュメント更新
- `style:` - コードスタイル修正（フォーマット、インデント等）
- `refactor:` - リファクタリング（機能変更なし）
- `test:` - テスト追加・修正
- `chore:` - その他（依存関係更新、設定変更等）
- `perf:` - パフォーマンス改善
- `ci:` - CI/CD 設定変更

### スコープ一覧

- `frontend` - フロントエンド（Next.js、React）
- `backend-go` - Go バックエンド
- `backend-python` - Backend Python サーバー
- `database` - データベース関連
- `auth` - 認証・認可関連
- `api` - API 関連
- `ui` - UI/UX 関連
- `config` - 設定ファイル関連
- `docs` - ドキュメント関連
- `deps` - 依存関係関連

### スコープの使い分け

- **単一のスコープに影響する場合**: `feat(frontend): チャット機能を追加`
- **複数のスコープに影響する場合**: `feat: 認証システムを実装`（スコープなし）
- **全体的な変更の場合**: `chore: プロジェクト設定を更新`（スコープなし）

## プルリクエスト

### タイトル形式

```
[{タイプ}] {変更内容の簡潔な説明}
```

### 例

```
[Feature] チャット機能にメッセージ暗号化を追加
[Fix] ログインリダイレクト問題を修正
[Docs] セットアップ手順を更新
[Refactor] 認証処理をリファクタリング
```

### 必須チェックリスト

#### コード品質

- [ ] テストが通る
- [ ] リンターエラーがない
- [ ] TypeScript の型エラーがない
- [ ] コードレビュー済み

#### ドキュメント

- [ ] ドキュメント更新済み（必要に応じて）
- [ ] README.md の更新（必要に応じて）
- [ ] API ドキュメントの更新（必要に応じて）

#### セキュリティ

- [ ] 機密情報がハードコーディングされていない
- [ ] セキュリティ脆弱性がない
- [ ] 認証・認可が適切に実装されている

### 説明テンプレート

プルリクエスト作成時に自動でテンプレートが表示されます。

詳細は [.github/pull_request_template.md](.github/pull_request_template.md) を参照。

## コードレビューのガイドライン

### レビュアー向け

- 機能要件を満たしているか確認
- セキュリティ上の問題がないか確認
- パフォーマンスに問題がないか確認
- コードの可読性・保守性を確認

### 開発者向け

- レビューコメントには丁寧に回答
- 修正が必要な場合は明確に理由を説明
- 質問がある場合は積極的に相談

## 緊急時の対応

### Hotfix の流れ

1. `hotfix/` ブランチを作成
2. 緊急修正を実装
3. テストを実行
4. 本番環境にデプロイ
5. 修正内容を `main` ブランチにマージ

### 緊急度の判断基準

- **Critical**: セキュリティ脆弱性、データ損失の可能性
- **High**: 主要機能が動作しない
- **Medium**: 一部機能に影響があるが回避策がある
- **Low**: 軽微な問題、次回リリースで対応可能
